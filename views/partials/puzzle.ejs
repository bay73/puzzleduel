<% if(typeof puzzle != 'undefined'){ %> 
<h2 class="card-body pt-0 pb-0 mb-0"><%= puzzle.type.name %></h2>
<p class="card-body text-right pb-0 pt-0 mb-0"><small><%= __('Author:') %> <%= puzzle.author %></small></p>
<svg id="mainGrid" class="col-xs-12 text-center" style="overflow: visible; z-index: 90;">
  <filter id="chooser">
    <feColorMatrix type="matrix" values="-1 0 0 0 1
                                         0 -1 0 0 1
                                         0 0 -1 0 1
                                         0 0 0 1 0"/>
  </filter>
  <filter id="bottomclue">
    <feColorMatrix type="matrix" values="-1 0 0 0 0.2
                                         0 -1 0 0 0.6
                                         0 0 -1 0 0.6
                                         0 0 0 1 0"/>
  </filter>
  <filter id="topclue">
    <feColorMatrix type="matrix" values="0 0 0 0 0
                                         0 0 0 0 0
                                         0 0 0 0 0
                                         0 0 0 1 0"/>
  </filter>
  <%= __('Sorry, but your browser is not supported. Try to setup the new version.') %>
</svg>
<div class="row card-body">
  <div class="col-8">
    <div class="d-flex flex-row flex-wrap">
      <button id="startBtn" type="button" class="btn btn-primary mb-3 mr-3"><%= __('Start') %></button>
      <button id="revertBtn" type="button" class="btn btn-primary mb-3 mr-3" style="display: none;"><%= __('Undo') %></button>
      <div class="mt-1 mr-3" id="pencilMarkCtrl" style="display: none;">
        <div class="custom-control custom-switch">
          <input type="checkbox" class="custom-control-input" id="pencilMarkCb">
          <label class="custom-control-label" for="pencilMarkCb"><%= __('Pencil-marks') %></label>
        </div>
      </div>
    </div>
  </div>
  <div class="col-4">
    <div class="d-flex flex-row-reverse flex-wrap">
      <button id="checkBtn" type="button" class="btn btn-primary mb-3 ml-3"><%= __('Check') %></button>
      <span id="timer" class="align-top" style="font-family: Lucida Console; font-size: 130%; display: none;"></span>
    </div>
  </div>
  <p class="card-text text-left mt-2"><%= puzzle.type.rules %></p>
  <p class="card-text text-left mt-1"><b><%= __('Grid control') %></b>:
    <% if(puzzle.type.puzzleJs=="chooser_square_puzzle.js") { %>
      <%= __('Click at a cell reveals the value chooser. Click at the selected value changes the state of the cell.') %>
    <% } else if(puzzle.type.puzzleJs=="path_square_puzzle.js") { %>
      <%= __('To draw a line press the mouse button at a start cell and move mouse to another cell holding the button.') %>
    <% } else { %>
      <%= __('Click the mouse button at the selected cell to change the filling of the cell.') %>
    <% } %>
    <%= __('More details about grid control are at the') %> <a href='/help'><%= __('help page') %></a>.
  </p>
</div>
<script src="/js/common.js"></script>
<script src="/js/<%= puzzle.type.puzzleJs %>"></script>
<script>
  function showPuzzle() {
    var controls = {
      startBtn: "#startBtn",
      revertBtn: "#revertBtn",
      checkBtn: "#checkBtn",
      pencilMarkCtrl: "#pencilMarkCtrl",
      pencilMarkCb: "#pencilMarkCb",
      timer: "#timer"
    };
    var puzzleData = {
      typeCode: "<%= puzzle.type.code %>",
      id: "<%= puzzle.code %>",
      dimension: "<%= puzzle.dimension %>"
    };
    puzzle = new <%= puzzle.type.puzzleObj %>(puzzleData, controls);
    puzzle.render(Snap("#mainGrid"));
  }
</script>
<% } %>
